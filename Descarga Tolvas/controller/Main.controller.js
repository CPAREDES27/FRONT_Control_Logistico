sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","./utilities","sap/ui/core/Core","sap/ui/core/routing/History","./formatter","sap/ui/model/json/JSONModel"],function(e,t,o,n,a,s,r){"use strict";return e.extend("com.tasa.tolvas.descargatolvas.controller.Main",{handleRouteMatched:function(e){var t="App60f18d59421c8929c54cd9bf";var o={};if(e.mParameters.data.context){this.sContext=e.mParameters.data.context}else{if(this.getOwnerComponent().getComponentData()){var n=function(e){if(Object.keys(e).length!==0){for(var t in e){if(t!=="sourcePrototype"&&t.includes("Set")){return t+"("+e[t][0]+")"}}}};this.sContext=n(this.getOwnerComponent().getComponentData().startupParameters)}}var a;if(this.sContext){a={path:"/"+this.sContext,parameters:o};this.getView().bindObject(a)}let s=new r(sap.ui.require.toUrl("com/tasa/tolvas/descargatolvas/mock/formFiltrosRegistro.json"));this.getView().setModel(s,"FormSearchModel")},_onButtonSearchPress:function(e){let t="",n=200,a=null,s=null,i="TVEG",l="20210706",u="FHERR DESCENDING HRERR DESCENDING CMIN ASCENDING",g=this.getView();t="ZV_FLOG";a=["CDMEN","CMIN","DSMEN","TPROG","MREMB","NMEMB","NRDES","FECCONMOV","PESACUMOD","DOC_MFBF","DOC_MB1B","DOC_MIGO","NROLOTE","NROPEDI","FIDES","HIDES","WERKS","DSPTA","CDSPC","DSSPC"];s=[{wa:`INDTR = 'P'`},{wa:`AND CDTPC = 'I'`},{wa:`AND ESREG = 'S'`},{wa:`AND (TPROG = 'G' OR (TPROG = 'A' AND CMIN = 'E'))`},{wa:`AND (WERKS LIKE 'TCNO')`},{wa:`AND (FECCONMOV BETWEEN '20210401' AND '20210831')`}];g.getModel("FormSearchModel").setProperty("/busyIndicatorTableDescargaTolvas",true);o.getDataFromReadTable(t,s,a,u,n).then(e=>{let t=e;g.getModel("FormSearchModel").setProperty("/busyIndicatorTableDescargaTolvas",false);g.setModel(new r({data:t}),"DescargaTolvaModel")})},onValidationError:function(e){const t=e.getSource();t.setValueState("Error");t.setValueStateText(e.getParameter("message"))},onPressRow:function(e){let t=e.getSource().getBindingContext("DescargaTolvaModel").getPath(),o=this.getOwnerComponent().getModel(),n;this.byId("PageDetailDescargaTolva").bindElement("DescargaTolvaModel>"+t);this.getOwnerComponent().getHelper().then(function(e){n=e.getNextUIState(1);o.setProperty("/layout",n.layout)})},handleClose:function(e){let t=this.getOwnerComponent().getModel(),o;this.getOwnerComponent().getHelper().then(function(e){o=e.getNextUIState(0);t.setProperty("/layout",o.layout)})},doNavigate:function(e,t,o,n){var a=t?t.getPath():null;var s=t?t.getModel():null;var r;if(a!==null&&a!==""){if(a.substring(0,1)==="/"){a=a.substring(1)}r=a.split("(")[0]}var i;var l=this.sMasterContext?this.sMasterContext:a;if(r!==null){i=n||this.getOwnerComponent().getNavigationPropertyForNavigationWithContext(r,e)}if(i!==null&&i!==undefined){if(i===""){this.oRouter.navTo(e,{context:a,masterContext:l},false)}else{s.createBindingContext(i,t,null,function(t){if(t){a=t.getPath();if(a.substring(0,1)==="/"){a=a.substring(1)}}else{a="undefined"}if(a==="undefined"){this.oRouter.navTo(e)}else{this.oRouter.navTo(e,{context:a,masterContext:l},false)}}.bind(this))}}else{this.oRouter.navTo(e)}if(typeof o==="function"){o()}},onInit:function(){this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getTarget("TargetMain").attachDisplay(jQuery.proxy(this.handleRouteMatched,this));var e=this.getView();e.addEventDelegate({onBeforeShow:function(){if(sap.ui.Device.system.phone){var t=e.getContent()[0];if(t.getShowNavButton&&!t.getShowNavButton()){t.setShowNavButton(true);t.attachNavButtonPress(function(){this.oRouter.navTo("MasterPage1",{},true)}.bind(this))}}}.bind(this)});this.bus=n.getEventBus();this.loadComboClaseMensaje()},loadComboClaseMensaje:function(){o.getDataFromDominios(["ZCLMIN"]).then(jQuery.proxy(e=>{this.getView().setModel(new r(e[0]),"ClaseMensajeModel")},this))},onAfterRendering:function(){console.log("onAfterRendering Main");this.bus.publish("flexible","Master")}})},true);