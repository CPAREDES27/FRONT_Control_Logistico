sap.ui.define(["./BaseController","sap/ui/model/json/JSONModel","../model/formatter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/ValidateException","sap/ui/core/Core","sap/ui/core/Popup","sap/m/PDFViewer","sap/ui/core/util/ExportTypeCSV","sap/ui/core/util/Export","sap/ui/export/library","sap/ui/export/Spreadsheet","sap/ui/core/BusyIndicator"],function(e,t,a,o,i,r,s,n,l,c,d,g,u,p,h,b,y){"use strict";var m=new sap.m.BusyDialog;const v="https://cf-nodejs-qas.cfapps.us10.hana.ondemand.com/api/";var P=null;var f="";var I=h.EdmType;const C="https://tasaqas.launchpad.cfapps.us10.hana.ondemand.com";return e.extend("com.tasa.valeviveres.controller.Worklist",{formatter:a,onInit:function(){let e=new t({});this.setModel(e,"consultaMareas");this.currentInputEmba="";this.primerOption=[];this.segundoOption=[];this.currentPage="";this.lastPage="";this.listPlanta();this.listAlmacen();this.listaCombos()},listaCombos:function(){var e=null;var t=null;var a={dominios:[{domname:"TEMPORADA",status:"A"},{domname:"ZINPRP",status:"A"}]};fetch(`${v}dominios/Listar`,{method:"POST",body:JSON.stringify(a)}).then(e=>e.json()).then(a=>{var o=a.data;console.log(o);e=a.data.find(e=>e.dominio=="TEMPORADA").data;t=a.data.find(e=>e.dominio=="ZINPRP").data;console.log(this.getView().getModel("Temporada").setProperty("/listaTemporada",e));console.log(this.getView().getModel("Propia").setProperty("/listaPropia",t));m.close()}).catch(e=>console.log(e))},onPress:function(e){this._showObject(e.getSource())},onNavBack:function(){history.go(-1)},onSearch:function(e){if(e.getParameters().refreshButtonPressed){this.onRefresh()}else{var t=[];var a=e.getParameter("query");if(a&&a.length>0){t=[new o("CategoryName",i.Contains,a)]}this._applySearch(t)}},onRefresh:function(){var e=this.byId("table");e.getBinding("items").refresh()},_showObject:function(e){let t=e.getBindingContext().getPath();if(!this.oDetailVale){this.oDetailVale=r.load({name:"com.tasa.valeviveres.fragments.DetailVale",controller:this}).then(e=>{this.getView().addDependent(e);return e})}this.oDetailVale.then(e=>{e.bindElement(t);e.open()})},_applySearch:function(e){var t=this.byId("table"),a=this.getModel("worklistView");t.getBinding("items").filter(e,"Application");if(e.length!==0){a.setProperty("/tableNoDataText",this.getResourceBundle().getText("worklistNoDataWithSearchText"))}},onClose:function(e){let t=e.getSource().getParent();t.close()},_onOpenDialogArmador:function(e){this.popUp=e;this.getView().getModel("Armador").setProperty("/listaArmador","");this._getDialogArmador().open()},_onCloseDialogArmador:function(){this._getDialogArmador().close();sap.ui.getCore().byId("idRuc2").setValue("");sap.ui.getCore().byId("idDescripcion").setValue("");sap.ui.getCore().byId("idCuentaProveedor").setValue("");sap.ui.getCore().byId("idListaArmador").setText("Lista de registros:")},onLimpiarArmador:function(){sap.ui.getCore().byId("idRuc2").setValue("");sap.ui.getCore().byId("idDescripcion").setValue();sap.ui.getCore().byId("idCuentaProveedor").setValue("");this.getView().getModel("Armador").setProperty("/listaArmador","")},onLimpiar:function(){this.byId("idValeIni").setValue("");this.byId("idValeFin").setValue("");this.byId("idFechaVivere").setValue("");this.byId("idArmadorIni").setValue("");this.byId("idEmbarcacion").setValue("");this.byId("idPlantaIni").setValue("");this.byId("idAlmacenIni").setValue("");this.byId("idAlmacenIni").setDescription("");this.byId("idAlmacenExterno").setValue("");this.byId("cboIndicador").setValue("");this.byId("idCentro").setValue("");this.byId("cboTemporada").setValue("");this.byId("idCantidad").setValue("200");this.getView().getModel("Vivere").setProperty("/listaVivere","")},_getDialogArmador:function(){if(!this._oDialogArmador){this._oDialogArmador=sap.ui.xmlfragment("com.tasa.valeviveres.view.DlgArmador",this.getView().getController());this.getView().addDependent(this._oDialogArmador);sap.ui.getCore().byId("idAciertosPop").setValue("200")}return this._oDialogArmador},buscar:function(e){console.log(e);var t=e.mParameters.listItem.oBindingContexts.Armador.sPath.split("/")[2];console.log(t);var a=this.getView().getModel("Armador").oData.listaArmador[t].STCD1;if(this.popUp==="popOne"){this.byId("idArmadorIni").setValue(a)}else if(this.popUp==="popTwo"){this.byId("idArmadorFin").setValue(a)}this._onCloseDialogArmador()},listaArmador:function(){m.open();var e=sap.ui.getCore().byId("idAciertosPop").getValue().trim();var t=sap.ui.getCore().byId("idRuc2").getValue().trim();var a=sap.ui.getCore().byId("idDescripcion").getValue().trim();var o=sap.ui.getCore().byId("idCuentaProveedor").getValue().trim();console.log(e);console.log(t);console.log(a);console.log(o);var i={delimitador:"|",fields:["KUNNR","NAME1","STCD1"],no_data:"",option:[],options:[{cantidad:"10",control:"INPUT",key:"KUNNR",valueHigh:"",valueLow:o},{cantidad:"10",control:"INPUT",key:"NAME1",valueHigh:"",valueLow:a},{cantidad:"10",control:"INPUT",key:"STCD1",valueHigh:"",valueLow:t}],order:"",p_user:"FGARCIA",rowcount:e,rowskips:0,tabla:"KNA1"};fetch(`${v}General/Read_table/`,{method:"POST",body:JSON.stringify(i)}).then(e=>e.json()).then(e=>{var t=e.data;console.log(t);console.log(this.getView().getModel("Armador").setProperty("/listaArmador",t));sap.ui.getCore().byId("idListaArmador").setText("Lista de registros: "+t.length);if(t.length<=0){sap.ui.getCore().byId("idListaArmador").setText("Lista de registros: No se encontraron resultados")}m.close()}).catch(function(e){if(e){s.error(e.message);m.close()}})},listPlanta:function(){m.open();var e={nombreAyuda:"BSQPLANTAS",p_user:"FGARCIA"};fetch(`${v}General/AyudasBusqueda`,{method:"POST",body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{var t=e.data;console.log(t);console.log(this.getView().getModel("Planta").setProperty("/listaPlanta",t));m.close()}).catch(e=>console.log(e))},listAlmacen:function(){m.open();var e={nombreAyuda:"BSQALMACEN",p_user:"FGARCIA"};fetch(`${v}General/AyudasBusqueda`,{method:"POST",body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{var t=e.data;console.log(e.data);console.log(this.getView().getModel("Almacen").setProperty("/listaAlmacen",t));m.close()}).catch(e=>console.log(e))},setCentro:function(){var e=this.byId("idPlantaIni").getValue();var t=this.getView().getModel("Planta").oData.listaPlanta;var a="";var o="";console.log(t);console.log(e);for(var i=0;i<t.length;i++){if(t[i].CDPTA===e){a=t[i].WERKS;o=t[i].DESCR}}if(this.byId("idPlantaIni")){this.byId("idCentro").setValue(a);this.byId("idPlantaIni").setDescription(o)}},onChangeAlmacen:function(){var e=this.byId("idAlmacenIni").getValue();var t=this.getView().getModel("Almacen").oData.listaAlmacen;var a="";var o="";console.log(t);console.log(e);if(!e){s.error("El código de Almacén no existe")}for(var i=0;i<t.length;i++){if(t[i].CDALM===e){a=t[i].DSALM;o=t[i].CDALE}}if(this.byId("idAlmacenIni")){this.byId("idAlmacenIni").setDescription(a);this.byId("idAlmacenExterno").setValue(o)}},castFecha:function(e){var t=new Date(e);var a=t.getMonth()+1;var o=t.getDate();var i=t.getFullYear();if(a<10){a=this.zeroFill(a,2)}if(o<10){o=this.zeroFill(o,2)}return i+""+a+""+o},zeroFill:function(e,t){t-=e.toString().length;if(t>0){return new Array(t+(/\./.test(e)?2:1)).join("0")+e}return e+""},onBusqueda:function(){var e=this.byId("idValeIni").getValue();var t=this.byId("idValeFin").getValue();var a=this.byId("idFechaVivere").getValue();var o=this.byId("idFechaVivere").mProperties.dateValue;var i=this.byId("idFechaVivere").mProperties.secondDateValue;var r=this.byId("idArmadorIni").getValue();var s=this.byId("idEmbarcacion").getValue();var n=this.byId("idPlantaIni").getValue();var l=this.byId("idAlmacenIni").getValue();var c=this.byId("cboTemporada").getSelectedKey();var d=this.byId("cboIndicador").getSelectedKey();var g=this.byId("idCantidad").getValue();var u=this.castFecha(o);var p=this.castFecha(i);this.fechaInicio=u;this.fechaFin=p;var h=[];if(e&&t){h.push({cantidad:"10",control:"MULTIINPUT",key:"NRVVI",valueHigh:t,valueLow:e})}if(e&&!t){h.push({cantidad:"10",control:"INPUT",key:"NRVVI",valueHigh:"",valueLow:e})}if(!e&&t){h.push({cantidad:"10",control:"INPUT",key:"NRVVI",valueHigh:"",valueLow:t})}if(a){h.push({cantidad:"10",control:"MULTIINPUT",key:"FCVVI",valueHigh:p,valueLow:u})}if(r){h.push({cantidad:"10",control:"INPUT",key:"ARCMC",valueHigh:"",valueLow:r})}if(s){h.push({cantidad:"10",control:"INPUT",key:"CDEMB",valueHigh:"",valueLow:s})}if(c){h.push({cantidad:"10",control:"COMBOBOX",key:"CDTPO",valueHigh:"",valueLow:c})}if(n){h.push({cantidad:"10",control:"INPUT",key:"CDPTA",valueHigh:"",valueLow:n})}if(l){h.push({cantidad:"10",control:"INPUT",key:"CDALM",valueHigh:"",valueLow:l})}if(d){h.push({cantidad:"10",control:"COMBOBOX",key:"INPRP",valueHigh:"",valueLow:d})}console.log(h);var b={fields:[],options1:[],options2:h,p_user:"FGARCIA",rowcount:g};m.open();fetch(`${v}valeviveres/Listar/`,{method:"POST",body:JSON.stringify(b)}).then(e=>e.json()).then(e=>{var t=e.data;console.log(t);this.getView().getModel("Vivere").setProperty("/listaVivere",t);m.close()}).catch(e=>console.log(e))},buscardd:function(e){var t=e.mParameters.rowContext.sPath.split("/")[2];var a=this.getModel("Vivere").getProperty("/listaVivere")[t];this.valeVivere=a;console.log(this.valeVivere);if(a.ESVVI!="A"){this.byId("idAnular").setEnabled(true);this.byId("idImprmir").setEnabled(true)}else{this.byId("idAnular").setEnabled(false);this.byId("idImprmir").setEnabled(false)}console.log(t)},onAnularVale:function(e){console.log("NUMERO "+this.valeVivere.NRVVI);this.onOpenDialog();sap.ui.getCore().byId("idVale").setValue(this.valeVivere.NRVVI)},onImprimir:function(e){var t="";if(e==="detail"){t=this.CodImprime}if(e==="lista"){t=this.valeVivere.NRVVI}var a={numValeVivere:t,p_user:"FGARCIA"};fetch(`${v}tripulantes/PDFValeViveres`,{method:"POST",body:JSON.stringify(a)}).then(e=>e.json()).then(e=>{this.showPDF(e.base64)}).catch(e=>console.log(e))},showPDF:function(e){this._PDFViewer2=null;var t=e;var a=atob(t);var o=new Uint8Array(a.length);for(var i=0;i<a.length;i++){o[i]=a.charCodeAt(i)}var r=new Blob([o.buffer],{type:"application/pdf"});var s=URL.createObjectURL(r);if(!this._PDFViewer2){this._PDFViewer2=new sap.m.PDFViewer({width:"auto",source:s});jQuery.sap.addUrlWhitelist("blob")}this._PDFViewer2.downloadPDF=function(){File.save(o.buffer,"Hello_UI5","pdf","application/pdf")};this._PDFViewer2.open();m.close()},onAnular:function(){var e=sap.ui.getCore().byId("idVale").getValue();var t=sap.ui.getCore().byId("idMotivo").getValue();if(!t){sap.ui.getCore().byId("idMotivo").setValueState(sap.ui.core.ValueState.Error)}var a={p_anula:"string",p_user:t,p_vale:e};m.open();fetch(`${v}valeviveres/AnularValev`,{method:"POST",body:JSON.stringify(a)}).then(e=>e.json()).then(e=>{s.success(e.t_mensaje[0].DSMIN);this.onCloseDialog();this.onBusqueda()}).catch(e=>console.log(e))},validaInput:function(){sap.ui.getCore().byId("idMotivo").setValueState()},_getDialog:function(){if(!this._oDialog){this._oDialog=sap.ui.xmlfragment("com.tasa.valeviveres.view.Vivere",this.getView().getController());this.getView().addDependent(this._oDialog)}return this._oDialog},onOpenDialog:function(){this._getDialog().open()},onCloseDialog:function(){this._getDialog().close()},_getsDialog:function(){if(!this._oDialog){this._oDialog=sap.ui.xmlfragment("com.tasa.valeviveres.view.Detail",this.getView().getController());this.getView().addDependent(this._oDialog)}return this._oDialog},onOpenDialogs:async function(e){await this.poblarSuministros(e);this._getsDialog().open()},onCloseDialogs:function(){this._getsDialog().close()},onNuevo:function(){},goNuevo:function(){this.getRouter().navTo("Nuevo")},poblarSuministros:async function(e){var t=e.oSource.oPropagatedProperties.oBindingContexts.Vivere.sPath.split("/")[2];this.getView().bindElement({path:"Vivere>/listaVivere/"+t});var a=this.getModel("Vivere").getProperty("/listaVivere")[t].NRVVI;this.CodImprime=a;var o=this.getModel("Vivere").getProperty("/listaVivere")[t].FFTVS;var i=this.getModel("Vivere").getProperty("/listaVivere")[t];var r=0;console.log(a);var s={fields:[],p_code:a,p_user:"FGARCIA"};await fetch(`${v}valeviveres/DetalleImpresionViveres`,{method:"POST",body:JSON.stringify(s)}).then(e=>e.json()).then(e=>{console.log(e.s_posicion);var t=e.s_posicion;for(var a=0;a<t.length;a++){r+=t[a].QTSUM;console.log(r);t.QTSUMTOTAL=r;t[a].FECHA=o}this.getView().getModel("Suministro").setProperty("/listaSuministro",t)}).catch(e=>console.log(e));this.getView().bindElement({path:"Suministro>/listaSuministro/"});this.onOpenDialogs()},onSearch:function(e){var t=[];var a=e.getSource().getValue();if(a&&a.length>0){var r=new o([new o("NRVVI",i.Contains,a),new o("NMEMB",i.Contains,a),new o("NAME1",i.Contains,a),new o("DSALM",i.Contains,a),new o("DESC_INPRP",i.Contains,a),new o("DSTPO",i.Contains,a),new o("FCVVI",i.Contains,a),new o("DESC_ESVVI",i.Contains,a),new o("AUFNR",i.Contains,a),new o("DESCR",i.Contains,a),new o("KOSTL",i.Contains,a)]);t.push(r)}var s=this.byId("table");var n=s.getBinding("rows");n.filter(t,"Application")},onExport:function(){var e,t,a,o;e=this.createColumnConfig();t=this.getView().getModel("Vivere").getProperty("/listaVivere");a={workbook:{columns:e,context:{application:"Debug Test Application",version:"1.95.0",title:"Some random title",modifiedBy:"John Doe",metaSheetName:"Custom metadata"}},dataSource:t,fileName:"REPORTE VALE DE VIVERES"};o=new b(a);o.build().then(function(){n.show("El Archivo ha sido exportado correctamente")}).finally(o.destroy)},createColumnConfig:function(){return[{label:"Vale",property:"NRVVI",type:I.String,scale:2},{label:"Temporada",property:"CDTPO",type:I.String,scale:2},{label:"Descripción Temporada",property:"DSTPO",type:I.String,scale:2},{label:"Planta",property:"CDPTA",type:I.String,scale:2},{label:"Descripción Planta",property:"DESCR",type:I.String,scale:2},{label:"Centro",property:"WERKS",type:I.String,scale:2},{label:"Almacén",property:"CDALM",type:I.String,scale:2},{label:"Descripción de Almacén",property:"DSALM",type:I.String,scale:2},{label:"Embarcación",property:"CDEMB",type:I.String,scale:2},{label:"Descripción Embarcación",property:"NMEMB",type:I.String,scale:2},{label:"Matrícula",property:"MREMB",type:I.String,scale:2},{label:"Armador",property:"CDEMP",type:I.String,scale:2},{label:"Descripción Armador",property:"NAME1",type:I.String,scale:2},{label:"Armador Comercial",property:"ARCMC",type:I.String,scale:2},{label:"Descripción Armador Comercial",property:"NAME2",type:I.String,scale:2},{label:"RUC Armador Comerc",property:"RUCCP",type:I.String,scale:2},{label:"Dirección",property:"DIREC",type:I.String,scale:2},{label:"Centro Costo",property:"KOSTL",type:I.String,scale:2},{label:"Código Cocinero",property:"PERNR",type:I.String,scale:2},{label:"Nombre Cocinero",property:"NMPER",type:I.String,scale:2},{label:"Proveedor",property:"CDPVE",type:I.String,scale:2},{label:"Descripción proveedor",property:"NAME3",type:I.String,scale:2},{label:"RUC Proveedor",property:"RUCCP",type:I.String,scale:2},{label:"Indicador Propiedad",property:"DESC_INPRP",type:I.String,scale:2},{label:"Número Tripulantes",property:"NRTRI",type:I.String,scale:2},{label:"Fecha Inicio Travesía",property:"FITVS",type:I.String,scale:2},{label:"Fecha Fin Travesía",property:"FFTVS",type:I.String,scale:2},{label:"Duración Travesía",property:"DRTVS",type:I.String,scale:2},{label:"Estado Impresión",property:"ESIMP",type:I.String,scale:2},{label:"Estado Registro",property:"DESC_ESVVI",type:I.String,scale:2},{label:"Documento Compra",property:"EBELN",type:I.String,scale:2},{label:"Documento Contable",property:"",type:I.String,scale:2},{label:"Orden Fabricación",property:"",type:I.String,scale:2},{label:"Observación",property:"OBVVI",type:I.String,scale:2},{label:"Fecha de creación",property:"FCVVI",type:I.String,scale:2}]},onSelectEmba:function(e){var t=e.getParameter("rowContext").getObject();if(t){var a=t.CDEMB;if(this.currentInputEmba.includes("embarcacionLow")){this.byId("embarcacionLow").setValue(a)}else if(this.currentInputEmba.includes("embarcacionHigh")){this.byId("embarcacionHigh").setValue(a)}this.getDialog().close()}},onSearchEmbarcacion:function(e){y.show(0);var t=sap.ui.getCore().byId("idEmba").getValue();var a=sap.ui.getCore().byId("idNombEmba").getValue();var o=sap.ui.getCore().byId("idMatricula").getValue();var i=sap.ui.getCore().byId("idRucArmador").getValue();var r=sap.ui.getCore().byId("idDescArmador").getValue();var s=sap.ui.getCore().byId("indicadorPropiedad").getSelectedKey();var n=[];var l=[];let c=[];n.push({cantidad:"20",control:"COMBOBOX",key:"ESEMB",valueHigh:"",valueLow:"O"});if(t){n.push({cantidad:"20",control:"INPUT",key:"CDEMB",valueHigh:"",valueLow:t})}if(a){n.push({cantidad:"20",control:"INPUT",key:"NMEMB",valueHigh:"",valueLow:a.toUpperCase()})}if(o){n.push({cantidad:"20",control:"INPUT",key:"MREMB",valueHigh:"",valueLow:o})}if(s){n.push({cantidad:"20",control:"COMBOBOX",key:"INPRP",valueHigh:"",valueLow:s})}if(i){l.push({cantidad:"20",control:"INPUT",key:"STCD1",valueHigh:"",valueLow:i})}if(r){l.push({cantidad:"20",control:"INPUT",key:"NAME1",valueHigh:"",valueLow:r.toUpperCase()})}this.primerOption=n;this.segundoOption=l;var d={option:[],option2:[],options:n,options2:l,p_user:"BUSQEMB"};fetch(`${v}embarcacion/ConsultarEmbarcacion/`,{method:"POST",body:JSON.stringify(d)}).then(e=>e.json()).then(e=>{console.log("Emba: ",e);c=e.data;this.getModel("consultaMareas").setProperty("/embarcaciones",c);this.getModel("consultaMareas").refresh();if(!isNaN(e.p_totalpag)){if(Number(e.p_totalpag)>0){sap.ui.getCore().byId("goFirstPag").setEnabled(true);sap.ui.getCore().byId("goPreviousPag").setEnabled(true);sap.ui.getCore().byId("comboPaginacion").setEnabled(true);sap.ui.getCore().byId("goLastPag").setEnabled(true);sap.ui.getCore().byId("goNextPag").setEnabled(true);var t="Página 1/"+Number(e.p_totalpag);this.getModel("consultaMareas").setProperty("/TituloEmba",t);var a=Number(e.p_totalpag)+1;var o=[];for(let e=1;e<a;e++){o.push({numero:e})}this.getModel("consultaMareas").setProperty("/NumerosPaginacion",o);sap.ui.getCore().byId("comboPaginacion").setSelectedKey("1");this.currentPage="1";this.lastPage=e.p_totalpag}else{var t="Página 1/1";this.getModel("consultaMareas").setProperty("/TituloEmba",t);this.getModel("consultaMareas").setProperty("/NumerosPaginacion",[]);sap.ui.getCore().byId("goFirstPag").setEnabled(false);sap.ui.getCore().byId("goPreviousPag").setEnabled(false);sap.ui.getCore().byId("comboPaginacion").setEnabled(false);sap.ui.getCore().byId("goLastPag").setEnabled(false);sap.ui.getCore().byId("goNextPag").setEnabled(false);this.currentPage="1";this.lastPage=e.p_totalpag}}y.hide()}).catch(e=>console.log(e))},onChangePag:function(e){var t=e.getSource().getId();var a=sap.ui.getCore().byId(t);var o=a.getSelectedKey();this.currentPage=o;this.onNavPage()},onSetCurrentPage:function(e){var t=e.getSource().getId();if(t=="goFirstPag"){this.currentPage="1"}else if(t=="goPreviousPag"){if(!isNaN(this.currentPage)){if(this.currentPage!="1"){var a=Number(this.currentPage)-1;this.currentPage=a.toString()}}}else if(t=="goNextPag"){if(!isNaN(this.currentPage)){if(this.currentPage!=this.lastPage){var o=Number(this.currentPage)+1;this.currentPage=o.toString()}}}else if(t=="goLastPag"){this.currentPage=this.lastPage}this.onNavPage()},onNavPage:function(){y.show(0);let e=[];var t={option:[],option2:[],options:this.primerOption,options2:this.segundoOption,p_user:"BUSQEMB",p_pag:this.currentPage};fetch(`${v}embarcacion/ConsultarEmbarcacion/`,{method:"POST",body:JSON.stringify(t)}).then(e=>e.json()).then(t=>{console.log("Emba: ",t);e=t.data;this.getModel("consultaMareas").setProperty("/embarcaciones",e);this.getModel("consultaMareas").refresh();var a="Página "+this.currentPage+"/"+Number(t.p_totalpag);this.getModel("consultaMareas").setProperty("/TituloEmba",a);sap.ui.getCore().byId("comboPaginacion").setSelectedKey(this.currentPage);y.hide()}).catch(e=>console.log(e))},getDialog:function(){if(!this.oDialog){this.oDialog=sap.ui.xmlfragment("com.tasa.valeviveres.view.Embarcacion",this);this.getView().addDependent(this.oDialog)}return this.oDialog},onOpenEmba:function(e){this.currentInputEmba=e.getSource().getId();this.getDialog().open()},buscarEmbarca:function(e){console.log(e);var t=e.mParameters.listItem.oBindingContexts.consultaMareas.sPath.split("/")[2];console.log(t);var a=this.getView().getModel("consultaMareas").oData.embarcaciones[t].CDEMB;this.byId("idEmbarcacion").setValue(a);this.onCerrarEmba()},onCerrarEmba:function(){this.clearFilterEmba();this.getDialog().close();this.getModel("consultaMareas").setProperty("/embarcaciones","");this.getModel("consultaMareas").setProperty("/TituloEmba","");sap.ui.getCore().byId("comboPaginacion").setEnabled(false);sap.ui.getCore().byId("goFirstPag").setEnabled(false);sap.ui.getCore().byId("goPreviousPag").setEnabled(false);sap.ui.getCore().byId("comboPaginacion").setEnabled(false);sap.ui.getCore().byId("goLastPag").setEnabled(false);sap.ui.getCore().byId("goNextPag").setEnabled(false);sap.ui.getCore().byId("comboPaginacion").setSelectedKey("1")},clearFilterEmba:function(){sap.ui.getCore().byId("idEmba").setValue("");sap.ui.getCore().byId("idNombEmba").setValue("");sap.ui.getCore().byId("idRucArmador").setValue("");sap.ui.getCore().byId("idMatricula").setValue("");sap.ui.getCore().byId("indicadorPropiedad").setValue("");sap.ui.getCore().byId("idDescArmador").setValue("");this.getModel("consultaMareas").setProperty("/TituloEmba","");this.getModel("consultaMareas").setProperty("/embarcaciones","")},onSearchHelp:function(e){let t=e.getSource().getId(),a=this.getModel(),o="busqembarcaciones",i="busqembarcaciones",r=C+"/9acc820a-22dc-4d66-8d69-bed5b2789d3c.AyudasBusqueda.busqembarcaciones-1.0.0",s=this.getView(),n=this.getView().byId(t);a.setProperty("/input",n);a.setProperty("/help",{});if(!this.DialogComponent){this.DialogComponent=new sap.m.Dialog({title:"Búsqueda de embarcaciones",icon:"sap-icon://search",state:"Information",endButton:new sap.m.Button({icon:"sap-icon://decline",text:"Cerrar",type:"Reject",press:function(e){this.onCloseDialog(e)}.bind(this)})});s.addDependent(this.DialogComponent);a.setProperty("/idDialogComp",this.DialogComponent.getId())}let l=function(e){y.hide()};if(this.DialogComponent.getContent().length===0){y.show(0);let e=new sap.ui.core.ComponentContainer({id:i,name:o,url:r,settings:{},componentData:{},propagateModel:true,componentCreated:l,height:"100%",async:false});this.DialogComponent.addContent(e)}this.DialogComponent.open()},onCloseDialog:function(e){e.getSource().getParent().close()}})});